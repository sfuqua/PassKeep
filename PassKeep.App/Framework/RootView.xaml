<local:RootPassKeepPage
    x:Class="PassKeep.Framework.RootView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:PassKeep.Framework"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <local:RootPassKeepPage.Resources>
        <Style x:Key="SplitViewButton" TargetType="Button">
            <Setter Property="Background" Value="{ThemeResource SystemControlBackgroundBaseLowBrush}"/>
            <Setter Property="Foreground" Value="{ThemeResource SystemControlForegroundBaseHighBrush}"/>
            <Setter Property="BorderBrush" Value="{ThemeResource SystemControlForegroundTransparentBrush}"/>
            <Setter Property="BorderThickness" Value="{ThemeResource ButtonBorderThemeThickness}"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontFamily" Value="{ThemeResource ContentControlThemeFontFamily}"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FontSize" Value="{ThemeResource ControlContentThemeFontSize}"/>
            <Setter Property="UseSystemFocusVisuals" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid x:Name="RootGrid" Background="{TemplateBinding Background}">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal" />
                                    <VisualState x:Name="PointerOver" />
                                    <VisualState x:Name="Pressed">
                                        <Storyboard>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="RootGrid">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlBackgroundBaseMediumLowBrush}"/>
                                            </ObjectAnimationUsingKeyFrames>
                                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="ContentPresenter">
                                                <DiscreteObjectKeyFrame KeyTime="0" Value="{ThemeResource SystemControlHighlightBaseHighBrush}"/>
                                            </ObjectAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <ContentPresenter x:Name="ContentPresenter" AutomationProperties.AccessibilityView="Raw" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" ContentTemplate="{TemplateBinding ContentTemplate}" ContentTransitions="{TemplateBinding ContentTransitions}" Content="{TemplateBinding Content}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                              Padding="0" Margin="8,4,8,4"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="SplitViewGlyph" TargetType="FontIcon">
            <Setter Property="Width" Value="52" />
            <Setter Property="FontFamily" Value="Segoe MDL2 Assets" />
            <Setter Property="FontSize" Value="30" />
        </Style>
    </local:RootPassKeepPage.Resources>

    <RelativePanel Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <!-- "Mobile" compressed view -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="mainSplitView.DisplayMode" Value="Overlay" />
                        <Setter Target="mainSplitView.IsPaneOpen" Value="False" />
                    </VisualState.Setters>
                </VisualState>

                <!-- "Main" view with compact flyout -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="720" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="mainSplitView.DisplayMode" Value="CompactInline" />
                        <Setter Target="mainSplitView.IsPaneOpen" Value="False" />
                    </VisualState.Setters>
                </VisualState>

                <!-- "Wide" view with open pane -->
                <VisualState>
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1000" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="mainSplitView.DisplayMode" Value="CompactInline" />
                        <Setter Target="mainSplitView.IsPaneOpen" Value="True" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

        <!-- "Chrome" -->
        <RelativePanel x:Name="appChrome" Background="{ThemeResource AppBarBackgroundThemeBrush}"
                       RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
            <!-- Hamburger/Title bar-->
            <Button x:Name="splitViewButton" Click="SplitViewToggle_Click"
                    Background="Transparent" Foreground="Purple"
                    Padding="12" Margin="0" Style="{StaticResource SplitViewButton}">
                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE700;" FontSize="32" />
            </Button>

            <!-- Back button -->
            <Button  x:Name="backButton" Command="{x:Bind ContentBackCommand, Mode=OneWay}"
                     RelativePanel.RightOf="splitViewButton" RelativePanel.AlignVerticalCenterWith="splitViewButton"
                     Style="{ThemeResource NavigationBackButtonNormalStyle}"
                     VerticalAlignment="Top"
                     AutomationProperties.Name="Back"
                     AutomationProperties.AutomationId="BackButton"
                     AutomationProperties.ItemType="Navigation Button"/>

            <TextBlock x:Uid="AppName" Text="Placeholder"
                       Margin="5" Style="{ThemeResource BodyTextBlockStyle}"
                       RelativePanel.RightOf="backButton" RelativePanel.AlignVerticalCenterWith="backButton" />
        </RelativePanel>

        <!-- Main content -->
        <SplitView x:Name="mainSplitView"
                   CompactPaneLength="52" OpenPaneLength="200"
                   RelativePanel.Below="appChrome"
                   RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True"
                   RelativePanel.AlignBottomWithPanel="True">
            <SplitView.Pane>
                <ListView x:Name="splitViewList" HorizontalAlignment="Stretch"
                          SelectionMode="Single" SelectionChanged="SplitViewList_SelectionChanged">
                    <!-- ListViewItems consisting of:
                            * Glyph
                            * TextBlocks to the right -->
                    <ListViewItem x:Name="homeItem" IsSelected="True">
                        <RelativePanel Margin="-12,0,0,0">
                            <FontIcon x:Name="homeGlyph" Style="{StaticResource SplitViewGlyph}" Glyph="&#xE10F;"></FontIcon>
                            <TextBlock x:Uid="Home" RelativePanel.RightOf="homeGlyph" RelativePanel.AlignVerticalCenterWith="homeGlyph">Home placeholder</TextBlock>
                        </RelativePanel>
                    </ListViewItem>

                    <ListViewItem x:Name="toggleLockItem"
                                  Visibility="{x:Bind ViewModel.OpenedFile, Converter={StaticResource ExistenceToVisibilityConverter}, Mode=OneWay}">
                        <RelativePanel Margin="-12,0,0,0">
                            <FontIcon x:Name="toggleLockGlyph" Style="{StaticResource SplitViewGlyph}" Glyph="{x:Bind UnlockedGlyph}"></FontIcon>
                            <TextBlock x:Uid="Unlocked" RelativePanel.RightOf="toggleLockGlyph" RelativePanel.AlignVerticalCenterWith="toggleLockGlyph">Toggle placeholder</TextBlock>
                        </RelativePanel>
                    </ListViewItem>
                    
                    <ListViewItem x:Name="openItem">
                        <RelativePanel Margin="-12,0,0,0">
                            <FontIcon x:Name="openGlyph" Style="{StaticResource SplitViewGlyph}" Glyph="&#xE1A5;"></FontIcon>
                            <TextBlock x:Uid="OpenDatabaseLabel" RelativePanel.RightOf="openGlyph" RelativePanel.AlignVerticalCenterWith="openGlyph">Open placeholder</TextBlock>
                        </RelativePanel>
                    </ListViewItem>
                    
                    <ListViewItem x:Name="helpItem">
                        <RelativePanel Margin="-12,0,0,0">
                            <FontIcon x:Name="helpGlyph" Style="{StaticResource SplitViewGlyph}" Glyph="&#xE11B;"></FontIcon>
                            <TextBlock x:Uid="Help" RelativePanel.RightOf="helpGlyph" RelativePanel.AlignVerticalCenterWith="helpGlyph">Help placeholder</TextBlock>
                        </RelativePanel>
                    </ListViewItem>

                    <ListViewItem x:Name="settingsItem">
                        <RelativePanel Margin="-12,0,0,0">
                            <FontIcon x:Name="settingsGlyph" Style="{StaticResource SplitViewGlyph}" Glyph="&#xE115;"></FontIcon>
                            <TextBlock x:Uid="Settings" RelativePanel.RightOf="settingsGlyph" RelativePanel.AlignVerticalCenterWith="settingsGlyph">Settings placeholder</TextBlock>
                        </RelativePanel>
                    </ListViewItem>
                    <!-- Use SelectionChanged for nav -->
                </ListView>
            </SplitView.Pane>
            <SplitView.Content>
                <Frame x:Name="contentFrame" Navigating="contentFrame_Navigating" Navigated="contentFrame_Navigated" />
            </SplitView.Content>
        </SplitView>

        <!-- "Loading" overlay -->
        <Grid x:Name="loadingPane" x:DeferLoadStrategy="Lazy" Visibility="Collapsed" Background="#33000000"
              RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True"
              RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignTopWithPanel="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="4*" />
                <RowDefinition Height="3*" />
                <RowDefinition Height="4*" />
            </Grid.RowDefinitions>

            <Grid Grid.Row="1" Background="#5005A0" Opacity="0.8">
                <ProgressRing x:Name="loadingStatusIndeterminate"
                              IsActive="True" Visibility="Collapsed"
                              HorizontalAlignment="Center" VerticalAlignment="Center"
                              Height="50" Width="50" Foreground="White" />
                <ProgressBar x:Name="loadingStatusDeterminate"
                             Minimum="0" Maximum="1" Value="0"
                             HorizontalAlignment="Center" VerticalAlignment="Center" />
                <TextBlock x:Name="loadingText"
                           FontSize="36" Margin="0,0,0,20"
                           HorizontalAlignment="Center" VerticalAlignment="Bottom"
                           Foreground="White" Text="Placeholder Text..." />
            </Grid>
        </Grid>
    </RelativePanel>
</local:RootPassKeepPage>
